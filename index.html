<html>
  <head>
    <style>
.container {
  position: absolute;
  text-align: top;
  color: white;
}

.bottom-left {
  position: absolute;
  bottom: 8px;
  left: 16px;
}

.top-left {
  position: absolute;
  top: 8px;
  left: 16px;
}

.top-right {
  position: absolute;
  top: 8px;
  right: 16px;
}

.bottom-right {
  position: absolute;
  bottom: 8px;
  right: 16px;
}

.centered {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -200%);
}
</style>
<div class="container">
  <img class="centered" src="hed.png" alt="Новошкольная ярмарка"align="top">
</div>
    <meta charset="utf-8">
    <meta http-equiv="refresh" content="600">

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <script type="text/javascript">

      google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(drawRateChart);

      function drawRateChart() {
        var spreadsheetUrl = "https://docs.google.com/spreadsheets/d/1QzdJdlkuANhB2ASYF_gFfBxAvjU57BEOUMBg4R2WK2Y/edit?sheet=Rate&range=B2";
        var query = new google.visualization.Query(spreadsheetUrl);
        query.send(handleRateChart);
      }

      function drawHousesChart() {
        var spreadsheetUrl = "https://docs.google.com/spreadsheets/d/1QzdJdlkuANhB2ASYF_gFfBxAvjU57BEOUMBg4R2WK2Y/edit?sheet=ShopsProfit&range=A3:B73";
        var query = new google.visualization.Query(spreadsheetUrl);
        query.send(handleHousesChart);
      }
      function drawHousesChart2() {
        var spreadsheetUrl = "https://docs.google.com/spreadsheets/d/1QzdJdlkuANhB2ASYF_gFfBxAvjU57BEOUMBg4R2WK2Y/edit?sheet=ShopsProfit&range=A74:B146";
        var query = new google.visualization.Query(spreadsheetUrl);
        query.send(handleHousesChart2);
      }

      function drawBanksChart() {
        var spreadsheetUrl = "https://docs.google.com/spreadsheets/d/1QzdJdlkuANhB2ASYF_gFfBxAvjU57BEOUMBg4R2WK2Y/edit?sheet=TotalProfit&range=A9:B29";
        var query = new google.visualization.Query(spreadsheetUrl);
        query.send(handleBanksChart);
      }

      function handleRateChart(response){
        var data = response.getDataTable();
        document.getElementById("chart").innerHTML = "1 NWC = " + data.getValue(0, 0) + " руб.";
      }

      function handleHousesChart(response){
        var data = response.getDataTable();
        var options = {
          annotations: {
            textStyle: {
              fontSize: 20
            }
          },
          chartArea:{left:'8%',top:'8%',width:'84%',height:'80%'},
          hAxis: {
            title:'Номер торгового дома',
            textStyle: {
              fontSize: 8
            },
            titleTextStyle: {
              fontSize: 28,
              italic: 0
            }
          },
          vAxis: {
            title:'Выручка в Ньюкоинах',
            titleTextStyle: {
              fontSize: 28,
              italic: 0
            },
            minorGridlines: {
              count: 5
            },
            minValue: '0'
          },
          title:'Выручка торговых домов',
          titleTextStyle: {
            fontSize: 50
          },
          width: window.innerWidth * 0.95,
          height: window.innerHeight * 0.95,
          legend:'none'
        };

        var view = new google.visualization.DataView(data);
        view.setColumns([0, 1,
                       { calc: "stringify",
                         sourceColumn: 1,
                         type: "string",
                         role: "annotation"
                       }]);
        var chart = new google.visualization.ColumnChart(document.getElementById('chart'));
        chart.draw(view, options);
      }
      function handleHousesChart2(response){
        var data = response.getDataTable();
        var options = {
          annotations: {
            textStyle: {
              fontSize: 20
            }
          },
          chartArea:{left:'8%',top:'8%',width:'84%',height:'80%'},
          hAxis: {
            title:'Номер торгового дома',
            textStyle: {
              fontSize: 8
            },
            titleTextStyle: {
              fontSize: 28,
              italic: 0
            }
          },
          vAxis: {
            title:'Выручка в Ньюкоинах',
            titleTextStyle: {
              fontSize: 28,
              italic: 0
            },
            minorGridlines: {
              count: 5
            },
            minValue: '0'
          },
          title:'Выручка торговых домов',
          titleTextStyle: {
            fontSize: 50
          },
          width: window.innerWidth * 0.95,
          height: window.innerHeight * 0.95,
          legend:'none'
        };

        var view = new google.visualization.DataView(data);
        view.setColumns([0, 1,
                       { calc: "stringify",
                         sourceColumn: 1,
                         type: "string",
                         role: "annotation"
                       }]);
        var chart = new google.visualization.ColumnChart(document.getElementById('chart'));
        chart.draw(view, options);
      }

      function handleBanksChart(response){
        var data = response.getDataTable();
        var options = {
          annotations: {
            textStyle: {
              fontSize: 19
            }
          },
          chartArea:{left:'8%',top:'8%',width:'84%',height:'80%'},
          hAxis: {
            textStyle: {
              fontSize: 15
            },
            titleTextStyle: {
              fontSize: 28,
              italic: 0
            }
          },
          vAxis: {
            titleTextStyle: {
              fontSize: 28,
              italic: 0
            },
            minorGridlines: {
              count: 5
            },
            minValue: '0'
          },
          title:'Общие сборы',
          titleTextStyle: {
            fontSize: 50
          },
          width: window.innerWidth * 0.95,
          height: window.innerHeight * 0.95,
          legend:'none'
        };

        var view = new google.visualization.DataView(data);
        view.setColumns([0, 1,
                       { calc: "stringify",
                         sourceColumn: 1,
                         type: "string",
                         role: "annotation"
                       }]);
        var formatter = new google.visualization.NumberFormat({suffix: ' руб.', groupingSymbol: ' '});
        formatter.format(data, 1); // Apply formatter to second column


        var chart = new google.visualization.LineChart(document.getElementById('chart'));
        chart.draw(view, options);
      }
      setTimeout(drawHousesChart, 5000);
      setTimeout(drawHousesChart2, 10000);
      setTimeout (drawBanksChart, 15000);
      setTimeout (drawRateChart, 17500);
      setInterval(function (){ setTimeout(drawHousesChart, 5000);setTimeout(drawHousesChart2, 10000); setTimeout (drawBanksChart, 15000); setTimeout (drawRateChart, 17500); }, 15000);

    </script>
    <style type>
      .center {
        display: flex;
        justify-content: center;
        align-items: center;
      }
      body {
        font-size: 8em;
      }
    </style>
  </head>
  <body class="center">
    <div id="chart" align="center"></div>
  </body>

</html>
